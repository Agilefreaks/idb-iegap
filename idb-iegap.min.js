navigator.userAgent.indexOf("Trident/")!==-1&&function(n,t){function a(n,t){return typeof t!="object"&&(t=t()),Object.keys(t).forEach(function(i){n[i]=t[i]}),n}function v(n){return{from:function(t){return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,{extend:function(i){a(n.prototype,typeof i!="object"?i(t.prototype):i)}}}}}function r(n,t){if(typeof n=="object")Object.keys(t).forEach(function(i){var u=Object.getOwnPropertyDescriptor(n,i),r=t[i](u);r.hasOwnProperty("value")&&r.writable!==!1&&(r.writable=!0);Object.defineProperty(n,i,a({configurable:!0,enumerable:!0},r))});else return t(n)}function s(n,i){var f,r,o,h,u,e;if(n.hasOwnProperty(i))return n[i];if(!i)return n;if(typeof i!="string"){for(f=[],r=0,o=i.length;r<o;++r)h=s(n,i[r]),f.push(h);return f}return(u=i.indexOf("."),u!==-1)?(e=n[i.substr(0,u)],e===t?t:s(e,i.substr(u+1))):t}function p(n){var t,i,u,r;if(!n||typeof n!="object")return n;if(Array.isArray(n))for(t=[],i=0,u=n.length;i<u;++i)t.push(p(n[i]));else if(n instanceof Date)t=new Date,t.setTime(n.getTime());else{t=n.constructor?Object.create(n.constructor.prototype):{};for(r in n)n.hasOwnProperty(r)&&(t[r]=p(n[r]))}return t}function it(n,t){return function(i){return n&&console.log("Warning: IEGap polyfill failed to "+(n.call?n():n)+": "+i.target.error),i.stopPropagation(),i.preventDefault(),t&&t(i),!1}}function wt(){for(var n=4;n>=-4;--n)w[n]=Math.pow(32768,n)}function ht(n,t,i){for(var r=t-1,o=n<0?32767:0,s=n<0?-n:n,u="",f,e;r>=-i;)f=s/w[r]&32767^o,e=f<<1|1,u+=String.fromCharCode(e),--r;return u}function rt(n,i,r,u){var e=0,o=i-1,h=n.length,f,s;if(i+r!=h)return t;for(f=0;f<h;++f)s=n.charCodeAt(f)-1>>1,u?e-=w[o]*(s^32767):e+=w[o]*s,--o;return e}function u(n){for(var t,r=n.length,u=new Array(r),i=0;i<r;++i)t=n[i],u[i]=t instanceof Date?"D"+ht(t.getTime(),4,0):typeof t=="string"?"S"+t:isNaN(t)?t?"J"+JSON.stringify(t):typeof t=="undefined"?"u":"0":(t<0?"N":"n")+ht(t,5,4);return JSON.stringify(u)}function h(n){for(var e=JSON.parse(n),o=e.length,s=new Array(o),f=0;f<o;++f){var h=e[f],r=h[0],u=h.substr(1),i=t;r==="D"?i=new Date(rt(u,4,0)):r==="J"?i=JSON.parse(u):r==="S"?i=u:r==="N"?i=rt(u,5,4,!0):r==="n"?i=rt(u,5,4,!1):r==="u"?i=t:r==="0"&&(i=null);s[f]=i}return s}function ut(n){return n.transaction.db._iegapmeta.stores[n.name]}function k(n,t,i){n._iegapmeta=i;t.objectStore("$iegapmeta").put(i,1)}function y(n){if(Array.isArray(n))return u(n);if(n instanceof l){var t=Array.isArray(n.upper)?u(n.upper):n.upper,i=Array.isArray(n.lower)?u(n.lower):n.lower;return n.lower===null?f.upperBound(t,n.upperOpen):n.upper===null?f.lowerBound(i,n.lowerOpen):f.bound(i,t,!!n.lowerOpen,!!n.upperOpen)}return n}function d(n,t){function r(){--u==0&&t&&t(i)}var u=n.length,i=0;n.forEach(function(n){var t=o.ObjectStore[n.op].apply(n.store,n.args);t.onsuccess=function(t){n.result=t.target.result;++i;r()};t.onerror=function(t){t.stopPropagation();t.preventDefault();n.error=t.target.error;r()}})}function ft(n,i,r,f,e){var h,l,o,c;(Array.isArray(r)&&(r=u(r)),h=s(i,f.keyPath),h!==t)&&(l=n.objectStore(f.idxStoreName),f.compound?(o={fk:r,k:u(h)},c=u([o.fk,o.k]),e.push({store:l,op:"add",args:[o,c]})):f.multiEntry&&(Array.isArray(h)?h.forEach(function(n){o={fk:r,k:n};c=u([o.fk,o.k]);e.push({store:l,op:"add",args:[o,c]})}):(o={fk:r,k:h},c=u([o.fk,o.k]),e.push({store:l,op:"add",args:[o,c]}))))}function et(n,t,i,r,u){this._idx=n;this._store=t;this._compound=Array.isArray(r);this._multiEntry=u;this.keyPath=r;this.name=i;this.objectStore=t;this.unique=n.unique}function g(n,t,i,r,u,f){this._cursor=n;this._store=i;this.direction=n.direction;this.key=u;this.primaryKey=r;this.source=t;arguments.length>=6&&(this.value=f)}function ct(){this._el={}}function ot(n){var t=document.createEvent("Event"),i,r;return t.initEvent(n,!0,!0),i=!1,r=!1,Object.defineProperties(t,{preventDefault:{value:function(){i=!0}},defaultPrevented:{get:function(){return i}},stopPropagation:{value:function(){r=!0}},propagationStopped:{get:function(){return r}}}),t}function e(n,t,i){this._el={};this.source=n;this.transaction=t;this.readyState="pending";var r=this,u={get:function(){return r}};i(function(n,t){r.result=t;Object.defineProperty(n,"target",u);r.readyState="done";r.dispatchEvent(n)},function(n,t){r.error=t||n.target.error;Object.defineProperty(n,"target",u);r.readyState="done";n.type!="error"&&Object.defineProperty(n,"type",{get:function(){return"error"}});r.dispatchEvent(n)},this)}function lt(n,t,i){e(n,t,i)}function c(n,t,i){var r=t.transaction.$iegQue;if(!r||r.length==0)return e(n,t.transaction,i);e(n,t.transaction,function(n,t,u){r.push(function(){i(n,t,u)})})}function at(n,t){var i=n.$iegQue;i&&i.length!=0?i.push(t):t()}function bt(n,t,i){var r=n.$iegQue||(n.$iegQue=[]),u=r[r.length-1];r.length!==0&&t&&t()&&u.reusableKeyGetter()==t()||(r.push({execute:i,reusableKeyGetter:t}),r.length===1&&nt(n))}function st(n){e(n.store,n.store.transaction,function(i,r,u){var h=n.store,l=h.transaction,f=l.$iegQue||(l.$iegQue=[]),v=n.op,y=v=="delete"?n.args[0]:h.keyPath?s(n.args[0]):n.args[1],e=y!==t&&h.name+":"+y,o,c;a(n,{trigSuccess:i,trigError:r,req:u});v!="delete"&&(n.args[0]=p(n.args[0]));f.length<=1||(o=f[f.length-1],o.execute)||o.keys.hasOwnProperty(e)?(c={ops:[n],keys:{}},e&&(c.keys[e]=!0),f.push(c),f.length==1&&nt(h.transaction)):(o.ops.push(n),e&&(o.keys[e]=!0))})}function nt(n){var t=n.$iegQue,i,r;if(t&&t.length!==0){for(i=t[0];typeof i=="function";){if(t.shift(),i(),t.length==0)return;i=t[0]}if(i.execute){i.execute(function(){t.shift();nt(n)});return}r=i.ops;kt(r);d(r,function(){dt(n,r,function(i){d(i,function(){function u(){--f==0&&(t.shift(),nt(n))}var i=!1,f=1;r.forEach(function(t){var r,e;if(i)t.trigError(new ot("error"),{name:"AbortError",message:"Transaction aborted"});else if(t.error){if(r=new ot("error"),t.trigError(r,t.error),r.defaultPrevented&&r.propagationStopped)return;r.defaultPrevented||(i=!0);++f;e=o.ObjectStore[t.op].apply(t.store,t.args);e.onerror=function(n){r.defaultPrevented&&n.preventDefault();r.propagationStopped&&n.stopPropagation();u()};e.onsuccess=function(){console.error("Request didnt fail when replayed! Oops! Fatal! Make sure transaction is aborted then...");n.abort();i=!0;u()}}else t.trigSuccess(new ot("success"),t.result)});u()})})})}}function kt(n){n.forEach(function(n){if(n.op==="add"||n.op==="put"){var f=n.args[0],e=n.store,r=ut(e),i=n.indexKeys=[],o=Object.keys(r.indexes).map(function(n){return r.indexes[n]});o.forEach(function(n){var r=s(f,n.keyPath),e=n.idxStoreName,o;if(r!==t&&r!==null)if(n.multiEntry)Array.isArray(r)?r.forEach(function(n){i.push({idxStoreName:e,key:n})}):i.push({idxStoreName:e,key:r});else if(n.compound)r&&(o=u(r),i.push({idxStoreName:e,key:o}));else throw"IEGap assert error";})}})}function dt(n,t,i){function f(){--u==0&&i(r)}var u=1,r=[];t.forEach(function(t){var s;if(!t.error){var e=t.op,h=ut(t.store),i=t.result,o=Object.keys(h.indexes).map(function(n){return h.indexes[n]});if(e==="add")o.forEach(function(u){ft(n,t.args[0],i,u,r)});else if(e=="put")o.forEach(function(e){++u;vt(e,i,function(u){var o=[];ft(n,t.args[0],i,e,o);o.forEach(function(n){u[n.args[1]]?delete u[n.args[1]]:r.push(n)});Object.keys(u).forEach(function(t){r.push({store:n.objectStore(e.idxStoreName),op:"delete",args:[t]})});f()})});else if(e=="delete")o.forEach(function(t){++u;vt(t,i,function(i){Object.keys(i).forEach(function(i){r.push({store:n.objectStore(t.idxStoreName),op:"delete",args:[i]})});f()})});else{s="IEGAP assert failure - bad operation: "+t.op;console.error(s);throw s;}}});f()}function vt(n,t,i){var f=transaction.objectStore(n.idxStoreName),e=o.ObjectStore.index.call(f,"pk"),r=e.openKeyCursor(t),u={};r.onerror=it("retrieving existing indexes",function(){i(u)});r.onsuccess=function(){var n=r.result;if(!n){i(u);return}u[n.primaryKey]=!0;n.continue()}}function l(n,t,i,r){this.lower=n;this.upper=t;this.lowerOpen=i;this.upperOpen=r}function yt(n){return Object.defineProperties(n,{contains:{configurable:!0,writable:!0,value:function(t){return n.indexOf(t)!==-1}},item:{configurable:!0,writable:!0,value:function(t){return n[t]}}}),n}function gt(){wt();n.open=r(n.open,function(n){return function(){var t=n.apply(this,arguments);return new lt(this,null,function(n,i,r){t.onerror=i;t.onblocked=function(n){r.dispatchEvent(n)};t.onupgradeneeded=function(n){var i,u;r.transaction=t.transaction;i=r.result=t.result;i._upgradeTransaction=t.transaction;i._iegapmeta={stores:{}};o.DB.objectStoreNames.get.apply(i).contains("$iegapmeta")||(u=o.DB.createObjectStore.call(i,"$iegapmeta"),u.add(i._iegapmeta,1));n.target=n.currentTarget=r;r.dispatchEvent(n)};t.onsuccess=function(r){var u=t.result,e,f;delete u._upgradeTransaction;u._iegapmeta={stores:{}};try{e=u.transaction(["$iegapmeta"],"readonly");f=e.objectStore("$iegapmeta").get(1);f.onerror=i;f.onsuccess=function(){u._iegapmeta=f.result;n(r,u)}}catch(o){i(r,o)}}})}});f.bound=r(f.bound,function(n){return function(t,i,r,u){return Array.isArray(t)?new l(t,i,r,u):n.apply(this,arguments)}});f.lowerBound=r(f.lowerBound,function(n){return function(t,i){return Array.isArray(t)?new l(t,null,i,null):n.apply(this,arguments)}});f.upperBound=r(f.upperBound,function(n){return function(t,i){return Array.isArray(t)?new l(null,t,null,i):n.apply(this,arguments)}});f.only=r(f.only,function(n){return function(t){return Array.isArray(t)?new l(t,t):n.apply(this,arguments)}});i.prototype.count=r(i.prototype.count,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,u;return(arguments.length>0&&(arguments[0]=y(t)),!i||i.metaStores.length==0)?n.apply(this,arguments):(r=this,u=arguments,new c(this,this,function(t,i){var f=n.apply(r,u);f.onsuccess=t;f.onerror=i}))}});i.prototype.get=r(i.prototype.get,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,u;return(arguments.length>0&&(arguments[0]=y(t)),!i||i.metaStores.length==0)?n.apply(this,arguments):(r=this,u=arguments,new c(this,this,function(t,i){var f=n.apply(r,u);f.onsuccess=t;f.onerror=i}))}});i.prototype.openCursor=r(i.prototype.openCursor,function(n){return function(t){var o=this.transaction.db._iegapmeta.stores[this.name],i,s,r,e;if(!o)return n.apply(this,arguments);if(Array.isArray(t)&&(t=new l(t,t)),i=o.compound,i&&t&&!(t instanceof l))throw new RangeError("Primary key is compound but given range is not.");return s=i&&t?f.bound(u(t.lower),u(t.upper),t.lowerOpen,t.upperOpen):t,arguments[0]=s,r=n.apply(this,arguments),e=this,new c(this,this,function(n,t){r.onerror=t;r.onsuccess=function(t){var r=t.target.result,u,f;r?(u=i?h(r.key):r.key,f=new g(r,e,e,u,u,r.value),n(t,f)):n(t,null)}})}});i.prototype.createIndex=r(i.prototype.createIndex,function(n){function t(n,t,i,r){var u=n.transaction.db,f="$iegap-"+n.name+"-"+t,e=u._iegapmeta,l;if(r.multiEntry&&Array.isArray(i)){o.DB.createObjectStore.call(u,"dummy",{keyPath:"",autoIncrement:!0});throw"invalid access";}var s=o.DB.createObjectStore.call(u,f,{autoIncrement:!1}),h=e.stores[n.name]||(e.stores[n.name]={indexes:{},metaStores:[]}),c={name:t,keyPath:i,multiEntry:r.multiEntry||!1,unique:r.unique||!1,compound:Array.isArray(i),storeName:n.name,idxStoreName:f};return h.indexes[t]=c,h.metaStores.push(f),s.createIndex("fk","fk",{unique:!1}),l=s.createIndex("k","k",{unique:r.unique||!1}),k(u,n.transaction,e),bt(n.transaction,null,function(t){var r=[],i=o.ObjectStore.openCursor.call(n);i.onsuccess=function(){var n=i.result;n?(ft(transaction,n.value,n.primaryKey,c,r),n.continue()):d(r,t)};i.onerror=it("index existing data in createIndex()",t)}),new et(l,n,t,i,r.multiEntry)}return function(i,r,u){return Array.isArray(r)||u&&u.multiEntry?t(this,i,r,u||{}):n.apply(this,arguments)}});i.prototype.deleteIndex=r(i.prototype.deleteIndex,function(n){return function(t){var i=this.transaction.db,f=i._iegapmeta,r=f.stores[this.name],u;if(!r||(u=r.indexes[t],!u))return n.apply(this,arguments);o.DB.deleteObjectStore.call(i,u.idxStoreName);delete r.indexes[t];k(i,this.transaction,f)}});i.prototype.index=r(i.prototype.index,function(n){return function(t){var r=this.transaction.db._iegapmeta.stores[this.name],i;return r?(i=r.indexes[t],i?new et(this.transaction.objectStore(i.idxStoreName).index("k"),this,i.name,i.keyPath,i.multiEntry):n.apply(this,arguments)):n.apply(this,arguments)}});i.prototype.add=r(i.prototype.add,function(n){return function(t,i){var r=ut(this),f,o;return r?r.compound?i?this.add(null):(i=u(s(t,r.keyPath)),new st({store:this,op:"add",args:[p(t),i],resultMapper:function(n){return h(n)}})):(f=Object.keys(r.indexes),!r.compound&&f.length===0)?n.apply(this,arguments):new st({store:this,op:"add",args:arguments}):n.apply(this,arguments)}});i.prototype.put=r(i.prototype.put,function(n){return function(t,i){var r=this.transaction.db._iegapmeta.stores[this.name],f,o,c;if(!r)return n.apply(this,arguments);if(r.compound){if(i)return this.add(null);i=u(s(t,r.keyPath));f=n.call(this,t,i)}else f=n.apply(this,arguments);return(o=Object.keys(r.indexes),!r.compound&&o.length===0)?f:(c=this,new e(this,this.transaction,function(n,i){function s(){function i(){--f==0&&n(e,r.compound?h(u):u)}var f=o.length;o.forEach(function(n){var f=r.indexes[n],e=c.transaction.objectStore(f.idxStoreName);bulkDelete(e.index("fk"),u,function(){if(f.multiEntry)addMultiEntryIndexKeys(e,f,t,u,null,i);else if(f.compound)addCompoundIndexKey(e,f,t,u,null,i);else{i();throw"IEGap assert error";}})})}var e=null,u;f.onerror=i;f.onsuccess=function(n){e=n;u=f.result;s()}}))}});i.prototype.delete=r(i.prototype.delete,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,f,o;return i?(i.compound&&(t=u(t)),r=n.call(this,t),f=Object.keys(i.indexes),f.length==0)?r:(o=this,new e(this,this.transaction,function(n,u){function s(){function u(){--r==0&&n(e)}var r=f.length;f.forEach(function(n){var r=i.indexes[n],f=o.transaction.objectStore(r.idxStoreName);bulkDelete(f.index("fk"),t,u)})}var e=null;r.onerror=u;r.onsuccess=function(n){e=n;s()}})):n.apply(this,arguments)}});i.prototype.clear=r(i.prototype.clear,function(n){return function(){var t=n.apply(this,arguments),i=this.transaction.db._iegapmeta.stores[this.name],r;return i?(r=this,new e(this,this.transaction,function(n,u){function o(){function u(){--t==0&&n(f)}var t=e.length;if(t===0)return n(f);e.forEach(function(n){var f=i.indexes[n],e=r.transaction.objectStore(f.idxStoreName),t=e.clear();t.onerror=it("clearing meta store",u);t.onsuccess=u})}var e=Object.keys(i.indexes),f=null;t.onerror=u;t.onsuccess=function(n){f=n;o()}})):t}});r(i.prototype,{indexNames:function(n){return{get:function(){var t=[].slice.call(n.get.apply(this)),i=this.transaction.db._iegapmeta.stores[this.name];return i&&(t=t.concat(Object.keys(i.indexes))),new yt(t)}}},autoIncrement:function(n){return{get:function(){var t=this.transaction.db._iegapmeta.stores[this.name];return t&&"autoIncrement"in t?t.autoIncrement:n.get.call(this)}}},keyPath:function(n){return{get:function(){var t=this.transaction.db._iegapmeta.stores[this.name];return t&&"keyPath"in t?t.keyPath:n.get.call(this)}}}});r(b.prototype,{transaction:function(n){return{value:function(t,i){t=typeof t=="string"?[t]:[].slice.call(t);var r=this._iegapmeta.stores;return t.forEach(function(n){var i=r[n];i&&(t=t.concat(i.metaStores))}),n.value.call(this,t,i||"readonly")}}},objectStoreNames:function(n){return{get:function(){return new yt([].slice.call(n.get.apply(this)).filter(function(n){return n.indexOf("$iegap")!==0}))}}},createObjectStore:function(n){return{value:function(t,i){var r,e=!1,u,f;if(i&&Array.isArray(i.keyPath)){if(e=!0,i.autoIncrement)throw new RangeError("Cannot autoincrement compound key");r=n.value.call(this,t)}else r=n.value.apply(this,arguments);return u=this._iegapmeta,f=u.stores[t]||(u.stores[t]={indexes:{},metaStores:[]}),f.keyPath=i&&i.keyPath||null,f.compound=e,f.autoIncrement=i&&i.autoIncrement||!1,k(this,r.transaction,u),r}}},deleteObjectStore:function(n){return{value:function(t){n.value.call(this,t);var i=this._iegapmeta,r=i.stores[t];if(r){if(r.metaStores.forEach(function(t){n.value.call(this,t)}),delete i.stores[t],!this._upgradeTransaction)throw"assert error";k(this,this._upgradeTransaction,i)}}}}})}var w={},f=window.IDBKeyRange,i=window.IDBObjectStore,b=window.IDBDatabase,pt=window.IDBIndex,o={DB:{objectStoreNames:Object.getOwnPropertyDescriptor(b.prototype,"objectStoreNames"),deleteObjectStore:b.prototype.deleteObjectStore,createObjectStore:b.prototype.createObjectStore},ObjectStore:{add:i.prototype.add,put:i.prototype.put,"delete":i.prototype.delete,get:i.prototype.get,count:i.prototype.count,openCursor:i.prototype.openCursor,index:i.prototype.index},Index:{openCursor:pt.prototype.openCursor}};v(et).from(Object).extend(function(){function n(n,t,i,r){return new c(n,n.objectStore,function(e,s){var c=n._compound,y=Array.isArray(n.objectStore.keyPath),a,v;c&&Array.isArray(t)&&(t=new l(t,t));a=c&&t?f.bound(u(t.lower),u(t.upper),t.lowerOpen,t.upperOpen):t;typeof a=="undefined"&&(a=null);v=o.Index.openCursor.call(n._idx,a,i);v.onerror=s;v.onsuccess=r?function(t){var i=t.target.result,r;i?(r=n._store.get(i.value.fk),r.onerror=s,r.onsuccess=function(){if(!r.result)return i.continue();var u=c?h(i.key):i.key,f=y?h(i.value.fk):i.value.fk;e(t,new g(i,n,n.objectStore,f,u,r.result))}):e(t,null)}:function(t){var i=t.target.result,r=c?h(i.key):i.key,u=y?h(i.value.fk):i.value.fk;e(t,i&&new g(i,n,n.objectStore,u,r))}})}return{count:function(n){arguments.length>0&&(arguments[0]=y(n));var t=this;return new c(this,this.objectStore,function(n,i){var r=t._idx.count.apply(this._idx,arguments);r.onsuccess=n;r.onerror=i})},get:function(n){var t=this;return new c(this,this.objectStore,function(i,r){var u=t._idx.get(y(n));u.onsuccess=function(n){var f=u.result&&u.result.fk;f?(u=t.objectStore.get(f),u.onsuccess=function(){i(n,u.result)},u.onerror=r):i(n)};u.onerror=r})},getKey:function(n){var t=this;return new c(this,this.objectStore,function(i,r){var u=t._idx.get(y(n));u.onsuccess=function(n){var t=n.target.result;i(n,t&&t.fk)};u.onerror=r})},openKeyCursor:function(t,i){return n(this,t,i)},openCursor:function(t,i){return n(this,t,i,!0)}}});a(g.prototype,function(){return{advance:function(n){var t=this;at(this._store.transaction,function(){t._cursor.advance(n)})},"continue":function(n){var t=this;at(this._store.transaction,function(){return n?Array.isArray(n)?t._cursor.continue(u(n)):t._cursor.continue(n):t._cursor.continue()})},"delete":function(){return this._store.delete(this.primaryKey)},update:function(n){return this._store.keyPath?this._store.put(n):this._store.put(n,this.primaryKey)}}});a(ct.prototype,function(){return{addEventListener:function(n,t){this._el[n]?this._el[n].push(t):this._el[n]=[t]},removeEventListener:function(n,t){var i=this._el[n],r;i&&(r=i.indexOf(t),r!==-1&&i.splice(r,1))},dispatchEvent:function(n){var t=this["on"+n.type],i,r,f;try{if(t&&t(n)===!1)return!1}catch(u){console.error(u)}if(i=this._el[n.type],i)for(r=0,f=i.length;r<f;++r){t=i[r];try{if((t.handleEvent||t)(n)===!1)return!1}catch(u){console.error(u)}}return!0}}});v(e).from(ct).extend({onsuccess:null,onerror:null});v(lt).from(e).extend({onblocked:null,onupgradeneeded:null});v(c).from(e);v(st).from(e);gt()}(window.indexedDB||window.msIndexedDB);
//# sourceMappingURL=idb-iegap.min.js.map

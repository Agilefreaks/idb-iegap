navigator.userAgent.indexOf("Trident/")!==-1&&function(n,t){function a(n,t){return typeof t!="object"&&(t=t()),Object.keys(t).forEach(function(i){n[i]=t[i]}),n}function v(n){return{from:function(t){return n.prototype=Object.create(t.prototype),n.prototype.constructor=n,{extend:function(i){a(n.prototype,typeof i!="object"?i(t.prototype):i)}}}}}function r(n,t){if(typeof n=="object")Object.keys(t).forEach(function(i){var u=Object.getOwnPropertyDescriptor(n,i),r=t[i](u);r.hasOwnProperty("value")&&r.writable!==!1&&(r.writable=!0);Object.defineProperty(n,i,a({configurable:!0,enumerable:!0},r))});else return t(n)}function o(n,i){var f,r,s,h,u,e;if(n.hasOwnProperty(i))return n[i];if(!i)return n;if(typeof i!="string"){for(f=[],r=0,s=i.length;r<s;++r)h=o(n,i[r]),f.push(h);return f}return(u=i.indexOf("."),u!==-1)?(e=n[i.substr(0,u)],e===t?t:o(e,i.substr(u+1))):t}function nt(n){var t,i,u,r;if(!n||typeof n!="object")return n;if(Array.isArray(n))for(t=[],i=0,u=n.length;i<u;++i)t.push(nt(n[i]));else if(n instanceof Date)t=new Date,t.setTime(n.getTime());else{t=n.constructor?Object.create(n.constructor.prototype):{};for(r in n)n.hasOwnProperty(r)&&(t[r]=nt(n[r]))}return t}function s(n,t){return function(i){return n&&console.log("Warning: IEGap polyfill failed to "+(n.call?n():n)+": "+i.target.error),i.stopPropagation(),i.preventDefault(),t&&t(i),!1}}function st(n,i,r,u,e,h){var c,l;try{if(c=o(r,i.keyPath),c===t)return h();l=n.add({fk:u,k:f(c)});l.onerror=s("add compound index",h);l.onsuccess=function(t){e&&e.push({store:n,op:"delete",args:[t.target.result]});h()}}catch(a){console.log("IEGap polyfill exception when adding compound index key");h()}}function ht(n,i,r,u,f,e){var h,c,l;try{if(h=o(r,i.keyPath),h===t)return e();if(Array.isArray(h)){h.forEach(function(t){var r=n.add({fk:u,k:t});r.onerror=s(function(){return"add multiEntry index "+t+" for "+i.storeName+"."+i.keyPath},a);r.onsuccess=function(t){f&&f.push({store:n,op:"delete",args:[t.target.result]});a()}});l=h.length;function a(){--l==0&&e()}}else c=n.add({fk:u,k:h}),c.onerror=s("add index",e),c.onsuccess=function(t){f&&f.push({store:n,op:"delete",args:[t.target.result]});e()}}catch(v){console.log("IEGap polyfill exception when adding multientry key")}}function ct(n,t,i){function f(){function r(){--t==0&&i()}var f=n.objectStore,t;u.forEach(function(n){var t=f.delete(n);t.onerror=s("delete meta index",r);t.onsuccess=r});t=u.length;t===0&&i()}var r=n.openKeyCursor(t),u=[];r.onerror=s("list indexed references",i);r.onsuccess=function(){var n=r.result;if(!n)return f();u.push(n.primaryKey);n.continue()}}function tt(n,t){function r(){--u==0&&t&&t(i)}var u=n.length,i=0;n.forEach(function(n){var t=it[n.op].apply(n.store,n.args);t.onsuccess=function(t){n.result=t.target.result;++i;r()};t.onerror=function(t){t.stopPropagation();t.preventDefault();n.error=t.target.error;r()}})}function wt(){for(var n=4;n>=-4;--n)p[n]=Math.pow(32768,n)}function lt(n,t,i){for(var r=t-1,o=n<0?32767:0,s=n<0?-n:n,u="",f,e;r>=-i;)f=s/p[r]&32767^o,e=f<<1|1,u+=String.fromCharCode(e),--r;return u}function rt(n,i,r,u){var e=0,o=i-1,h=n.length,f,s;if(i+r!=h)return t;for(f=0;f<h;++f)s=n.charCodeAt(f)-1>>1,u?e-=p[o]*(s^32767):e+=p[o]*s,--o;return e}function f(n){for(var t,r=n.length,u=new Array(r),i=0;i<r;++i)t=n[i],u[i]=t instanceof Date?"D"+lt(t.getTime(),4,0):typeof t=="string"?"S"+t:isNaN(t)?t?"J"+JSON.stringify(t):typeof t=="undefined"?"u":"0":(t<0?"N":"n")+lt(t,5,4);return JSON.stringify(u)}function h(n){for(var e=JSON.parse(n),o=e.length,s=new Array(o),f=0;f<o;++f){var h=e[f],r=h[0],u=h.substr(1),i=t;r==="D"?i=new Date(rt(u,4,0)):r==="J"?i=JSON.parse(u):r==="S"?i=u:r==="N"?i=rt(u,5,4,!0):r==="n"?i=rt(u,5,4,!1):r==="u"?i=t:r==="0"&&(i=null);s[f]=i}return s}function ut(n){return n.transaction.db._iegapmeta.stores[n.name]}function b(n,t,i){n._iegapmeta=i;t.objectStore("$iegapmeta").put(i,1)}function y(n){if(Array.isArray(n))return f(n);if(n instanceof l){var t=Array.isArray(n.upper)?f(n.upper):n.upper,i=Array.isArray(n.lower)?f(n.lower):n.lower;return n.lower===null?u.upperBound(t,n.upperOpen):n.upper===null?u.lowerBound(i,n.lowerOpen):u.bound(i,t,!!n.lowerOpen,!!n.upperOpen)}return n}function ft(n,t,i,r,u){this._idx=n;this._store=t;this._compound=Array.isArray(r);this._multiEntry=u;this.keyPath=r;this.name=i;this.objectStore=t;this.unique=n.unique}function k(n,t,i,r,u,f){this._cursor=n;this._store=i;this.direction=n.direction;this.key=u;this.primaryKey=r;this.source=t;arguments.length>=6&&(this.value=f)}function at(){this._el={}}function et(n){var t=document.createEvent("Event"),i,r;return t.initEvent(n,!0,!0),i=!1,r=!1,Object.defineProperties(t,{preventDefault:{value:function(){i=!0}},defaultPrevented:{get:function(){return i}},stopPropagation:{value:function(){r=!0}},propagationStopped:{get:function(){return r}}}),t}function e(n,t,i){this._el={};this.source=n;this.transaction=t;this.readyState="pending";var r=this,u={get:function(){return r}};i(function(n,t){r.result=t;Object.defineProperty(n,"target",u);r.readyState="done";r.dispatchEvent(n)},function(n,t){r.error=t||n.target.error;Object.defineProperty(n,"target",u);r.readyState="done";n.type!="error"&&Object.defineProperty(n,"type",{get:function(){return"error"}});r.dispatchEvent(n)},this)}function vt(n,t,i){e(n,t,i)}function c(n,t,i){var r=t.transaction.$iegQue;if(!r||r.length==0)return e(n,t.transaction,i);e(n,t.transaction,function(n,t,u){r.push(function(){i(n,t,u)})})}function yt(n,t){var i=n.$iegQue;i&&i.length!=0?i.push(t):t()}function bt(n,t,i){var r=n.$iegQue||(n.$iegQue=[]),u=r[r.length-1];r.length!==0&&t&&t()&&u.reusableKeyGetter()==t()||(r.push({execute:i,reusableKeyGetter:t}),r.length===1&&d(n))}function ot(n){e(n.store,n.store.transaction,function(i,r,u){var h=n.store,l=h.transaction,f=l.$iegQue||(l.$iegQue=[]),v=n.op,y=v=="delete"?n.args[0]:h.keyPath?o(n.args[0]):n.args[1],e=y!==t&&h.name+":"+y,s,c;a(n,{trigSuccess:i,trigError:r,req:u});v!="delete"&&(n.args[0]=nt(n.args[0]));f.length<=1||(s=f[f.length-1],s.execute)||s.keys.hasOwnProperty(e)?(c={ops:[n],keys:{}},e&&(c.keys[e]=!0),f.push(c),f.length==1&&d(h.transaction)):(s.ops.push(n),e&&(s.keys[e]=!0))})}function d(n){var t=n.$iegQue,i,r;if(t&&t.length!==0){for(i=t[0];typeof i=="function";){if(t.shift(),i(),t.length==0)return;i=t[0]}if(i.execute){i.execute(function(){t.shift();d(n)});return}r=i.ops;kt(r);tt(r,function(){dt(n,r,function(i){tt(i,function(){function u(){--f==0&&(t.shift(),d(n))}var i=!1,f=1;r.forEach(function(t){var r,e;if(i)t.trigError(new et("error"),{name:"AbortError",message:"Transaction aborted"});else if(t.error){if(r=new et("error"),t.trigError(r,t.error),r.defaultPrevented&&r.propagationStopped)return;r.defaultPrevented||(i=!0);++f;e=it[t.op].apply(t.store,t.args);e.onerror=function(n){r.defaultPrevented&&n.preventDefault();r.propagationStopped&&n.stopPropagation();u()};e.onsuccess=function(){console.error("Request didnt fail when replayed! Oops! Fatal! Make sure transaction is aborted then...");n.abort();i=!0;u()}}else t.trigSuccess(new et("success"),t.result)});u()})})})}}function kt(n){n.forEach(function(n){if(n.op==="add"||n.op==="put"){var u=n.args[0],e=n.store,r=ut(e),i=n.indexKeys=[],s=Object.keys(r.indexes).map(function(n){return r.indexes[n]});s.forEach(function(n){var r=o(u,n.keyPath),e=n.idxStoreName,s;if(r!==t&&r!==null)if(n.multiEntry)Array.isArray(r)?r.forEach(function(n){i.push({idxStoreName:e,key:n})}):i.push({idxStoreName:e,key:r});else if(n.compound)r&&(s=f(r),i.push({idxStoreName:e,key:s}));else throw"IEGap assert error";})}})}function dt(n,t,i){function f(){--r==0&&i(u)}var r=1,u=[];t.forEach(function(n){var i;if(!n.error){var t=n.op,r=ut(n.store),u=Object.keys(r.indexes).map(function(n){return r.indexes[n]});if(t!=="add"&&t!="put"&&t!="delete"){i="IEGAP assert failure - bad operation: "+n.op;console.error(i);throw i;}}});f()}function l(n,t,i,r){this.lower=n;this.upper=t;this.lowerOpen=i;this.upperOpen=r}function pt(n){return Object.defineProperties(n,{contains:{configurable:!0,writable:!0,value:function(t){return n.indexOf(t)!==-1}},item:{configurable:!0,writable:!0,value:function(t){return n[t]}}}),n}function gt(){var a=Object.getOwnPropertyDescriptor(w.prototype,"objectStoreNames").get,v=w.prototype.deleteObjectStore,t=w.prototype.createObjectStore;wt();n.open=r(n.open,function(n){return function(){var i=n.apply(this,arguments);return new vt(this,null,function(n,r,u){i.onerror=r;i.onblocked=function(n){u.dispatchEvent(n)};i.onupgradeneeded=function(n){var r,f;u.transaction=i.transaction;r=u.result=i.result;r._upgradeTransaction=i.transaction;r._iegapmeta={stores:{}};a.apply(r).contains("$iegapmeta")||(f=t.call(r,"$iegapmeta"),f.add(r._iegapmeta,1));n.target=n.currentTarget=u;u.dispatchEvent(n)};i.onsuccess=function(t){var u=i.result,e,f;delete u._upgradeTransaction;u._iegapmeta={stores:{}};try{e=u.transaction(["$iegapmeta"],"readonly");f=e.objectStore("$iegapmeta").get(1);f.onerror=r;f.onsuccess=function(){u._iegapmeta=f.result;n(t,u)}}catch(o){r(t,o)}}})}});u.bound=r(u.bound,function(n){return function(t,i,r,u){return Array.isArray(t)?new l(t,i,r,u):n.apply(this,arguments)}});u.lowerBound=r(u.lowerBound,function(n){return function(t,i){return Array.isArray(t)?new l(t,null,i,null):n.apply(this,arguments)}});u.upperBound=r(u.upperBound,function(n){return function(t,i){return Array.isArray(t)?new l(null,t,null,i):n.apply(this,arguments)}});u.only=r(u.only,function(n){return function(t){return Array.isArray(t)?new l(t,t):n.apply(this,arguments)}});i.prototype.count=r(i.prototype.count,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,u;return(arguments.length>0&&(arguments[0]=y(t)),!i||i.metaStores.length==0)?n.apply(this,arguments):(r=this,u=arguments,new c(this,this,function(t,i){var f=n.apply(r,u);f.onsuccess=t;f.onerror=i}))}});i.prototype.get=r(i.prototype.get,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,u;return(arguments.length>0&&(arguments[0]=y(t)),!i||i.metaStores.length==0)?n.apply(this,arguments):(r=this,u=arguments,new c(this,this,function(t,i){var f=n.apply(r,u);f.onsuccess=t;f.onerror=i}))}});i.prototype.openCursor=r(i.prototype.openCursor,function(n){return function(t){var o=this.transaction.db._iegapmeta.stores[this.name],i,s,r,e;if(!o)return n.apply(this,arguments);if(Array.isArray(t)&&(t=new l(t,t)),i=o.compound,i&&t&&!(t instanceof l))throw new RangeError("Primary key is compound but given range is not.");return s=i&&t?u.bound(f(t.lower),f(t.upper),t.lowerOpen,t.upperOpen):t,arguments[0]=s,r=n.apply(this,arguments),e=this,new c(this,this,function(n,t){r.onerror=t;r.onsuccess=function(t){var r=t.target.result,u,f;r?(u=i?h(r.key):r.key,f=new k(r,e,e,u,u,r.value),n(t,f)):n(t,null)}})}});i.prototype.createIndex=r(i.prototype.createIndex,function(n){function i(n,i,r,u){var f=n.transaction.db,e="$iegap-"+n.name+"-"+i,o=f._iegapmeta,a,h;if(u.multiEntry&&Array.isArray(r)){t.call(f,"dummy",{keyPath:"",autoIncrement:!0});throw"invalid access";}var c=t.call(f,e,{autoIncrement:!0}),l=o.stores[n.name]||(o.stores[n.name]={indexes:{},metaStores:[]}),v={name:i,keyPath:r,multiEntry:u.multiEntry||!1,unique:u.unique||!1,compound:Array.isArray(r),storeName:n.name,idxStoreName:e};return l.indexes[i]=v,l.metaStores.push(e),c.createIndex("fk","fk",{unique:!1}),a=c.createIndex("k","k",{unique:u.unique||!1}),b(f,n.transaction,o),h=n.name,bt(n.transaction,function(){return h},function(t){function r(i,r){var u=null;i.forEach(function(t){u=n.put(t);u.onerror=s("reindex existing object")});r&&(u?(u.onerror=s("reindex the last object",t),u.onsuccess=t):t())}var i=[];n.openCursor().onsuccess=function(n){h=null;var t=n.target.result;t?(i.push(t.value),i.length===1e3&&(r(i,!1),i=[]),t.continue()):r(i,!0)}}),n._reindexing||(n._reindexing=!0,n.openCursor().onsuccess=function(t){delete n._reindexing;var i=t.target.result;i&&(i.update(i.value),i.continue())}),new ft(a,n,i,r,u.multiEntry)}return function(t,r,u){return Array.isArray(r)||u&&u.multiEntry?i(this,t,r,u||{}):n.apply(this,arguments)}});i.prototype.deleteIndex=r(i.prototype.deleteIndex,function(n){return function(t){var i=this.transaction.db,f=i._iegapmeta,r=f.stores[this.name],u;if(!r||(u=r.indexes[t],!u))return n.apply(this,arguments);v.call(i,u.idxStoreName);delete r.indexes[t];b(i,this.transaction,f)}});i.prototype.index=r(i.prototype.index,function(n){return function(t){var r=this.transaction.db._iegapmeta.stores[this.name],i;return r?(i=r.indexes[t],i?new ft(this.transaction.objectStore(i.idxStoreName).index("k"),this,i.name,i.keyPath,i.multiEntry):n.apply(this,arguments)):n.apply(this,arguments)}});i.prototype.add=r(i.prototype.add,function(n){return function(t,i){var r=ut(this),u,s;return r?r.compound?i?this.add(null):(i=f(o(t,r.keyPath)),new ot({store:this,op:"add",args:[t,i],resultMapper:function(n){return h(n)}})):(u=Object.keys(r.indexes),!r.compound&&u.length===0)?n.apply(this,arguments):new ot({store:this,op:"add",args:arguments}):n.apply(this,arguments)}});i.prototype.put=r(i.prototype.put,function(n){return function(t,i){var r=this.transaction.db._iegapmeta.stores[this.name],u,s,c;if(!r)return n.apply(this,arguments);if(r.compound){if(i)return this.add(null);i=f(o(t,r.keyPath));u=n.call(this,t,i)}else u=n.apply(this,arguments);return(s=Object.keys(r.indexes),!r.compound&&s.length===0)?u:(c=this,new e(this,this.transaction,function(n,i){function o(){function i(){--u==0&&n(e,r.compound?h(f):f)}var u=s.length;s.forEach(function(n){var u=r.indexes[n],e=c.transaction.objectStore(u.idxStoreName);ct(e.index("fk"),f,function(){if(u.multiEntry)ht(e,u,t,f,null,i);else if(u.compound)st(e,u,t,f,null,i);else{i();throw"IEGap assert error";}})})}var e=null,f;u.onerror=i;u.onsuccess=function(n){e=n;f=u.result;o()}}))}});i.prototype.delete=r(i.prototype.delete,function(n){return function(t){var i=this.transaction.db._iegapmeta.stores[this.name],r,u,o;return i?(i.compound&&(t=f(t)),r=n.call(this,t),u=Object.keys(i.indexes),u.length==0)?r:(o=this,new e(this,this.transaction,function(n,f){function s(){function f(){--r==0&&n(e)}var r=u.length;u.forEach(function(n){var r=i.indexes[n],u=o.transaction.objectStore(r.idxStoreName);ct(u.index("fk"),t,f)})}var e=null;r.onerror=f;r.onsuccess=function(n){e=n;s()}})):n.apply(this,arguments)}});i.prototype.clear=r(i.prototype.clear,function(n){return function(){var t=n.apply(this,arguments),i=this.transaction.db._iegapmeta.stores[this.name],r;return i?(r=this,new e(this,this.transaction,function(n,u){function o(){function u(){--t==0&&n(f)}var t=e.length;if(t===0)return n(f);e.forEach(function(n){var f=i.indexes[n],e=r.transaction.objectStore(f.idxStoreName),t=e.clear();t.onerror=s("clearing meta store",u);t.onsuccess=u})}var e=Object.keys(i.indexes),f=null;t.onerror=u;t.onsuccess=function(n){f=n;o()}})):t}});r(i.prototype,{indexNames:function(n){return{get:function(){var t=[].slice.call(n.get.apply(this)),i=this.transaction.db._iegapmeta.stores[this.name];return i&&(t=t.concat(Object.keys(i.indexes))),new pt(t)}}},autoIncrement:function(n){return{get:function(){var t=this.transaction.db._iegapmeta.stores[this.name];return t&&"autoIncrement"in t?t.autoIncrement:n.get.call(this)}}},keyPath:function(n){return{get:function(){var t=this.transaction.db._iegapmeta.stores[this.name];return t&&"keyPath"in t?t.keyPath:n.get.call(this)}}}});r(w.prototype,{transaction:function(n){return{value:function(t,i){t=typeof t=="string"?[t]:[].slice.call(t);var r=this._iegapmeta.stores;return t.forEach(function(n){var i=r[n];i&&(t=t.concat(i.metaStores))}),n.value.call(this,t,i||"readonly")}}},objectStoreNames:function(n){return{get:function(){return new pt([].slice.call(n.get.apply(this)).filter(function(n){return n.indexOf("$iegap")!==0}))}}},createObjectStore:function(n){return{value:function(t,i){var r,e=!1,u,f;if(i&&Array.isArray(i.keyPath)){if(e=!0,i.autoIncrement)throw new RangeError("Cannot autoincrement compound key");r=n.value.call(this,t)}else r=n.value.apply(this,arguments);return u=this._iegapmeta,f=u.stores[t]||(u.stores[t]={indexes:{},metaStores:[]}),f.keyPath=i&&i.keyPath||null,f.compound=e,f.autoIncrement=i&&i.autoIncrement||!1,b(this,r.transaction,u),r}}},deleteObjectStore:function(n){return{value:function(t){n.value.call(this,t);var i=this._iegapmeta,r=i.stores[t];if(r){if(r.metaStores.forEach(function(t){n.value.call(this,t)}),delete i.stores[t],!this._upgradeTransaction)throw"assert error";b(this,this._upgradeTransaction,i)}}}}})}var p={},u=window.IDBKeyRange,i=window.IDBObjectStore,w=window.IDBDatabase,it={};a(it,i.prototype);v(ft).from(Object).extend(function(){function n(n,t,i,r){return new c(n,n.objectStore,function(e,o){var s=n._compound,v=Array.isArray(n.objectStore.keyPath),c,a;s&&Array.isArray(t)&&(t=new l(t,t));c=s&&t?u.bound(f(t.lower),f(t.upper),t.lowerOpen,t.upperOpen):t;typeof c=="undefined"&&(c=null);a=n._idx.openCursor(c,i);a.onerror=o;a.onsuccess=r?function(t){var i=t.target.result,r;i?(r=n._store.get(i.value.fk),r.onerror=o,r.onsuccess=function(){if(!r.result)return i.continue();var u=s?h(i.key):i.key,f=v?h(i.value.fk):i.value.fk;e(t,new k(i,n,n.objectStore,f,u,r.result))}):e(t,null)}:function(t){var i=t.target.result,r=s?h(i.key):i.key,u=v?h(i.value.fk):i.value.fk;e(t,i&&new k(i,n,n.objectStore,u,r))}})}return{count:function(n){arguments.length>0&&(arguments[0]=y(n));var t=this;return new c(this,this.objectStore,function(n,i){var r=t._idx.count.apply(this._idx,arguments);r.onsuccess=n;r.onerror=i})},get:function(n){var t=this;return new c(this,this.objectStore,function(i,r){var u=t._idx.get(y(n));u.onsuccess=function(n){var f=u.result&&u.result.fk;f?(u=t.objectStore.get(f),u.onsuccess=function(){i(n,u.result)},u.onerror=r):i(n)};u.onerror=r})},getKey:function(n){var t=this;return new c(this,this.objectStore,function(i,r){var u=t._idx.get(y(n));u.onsuccess=function(n){var t=n.target.result;i(n,t&&t.fk)};u.onerror=r})},openKeyCursor:function(t,i){return n(this,t,i)},openCursor:function(t,i){return n(this,t,i,!0)}}});a(k.prototype,function(){return{advance:function(n){var t=this;yt(this._store.transaction,function(){t._cursor.advance(n)})},"continue":function(n){var t=this;yt(this._store.transaction,function(){return n?Array.isArray(n)?t._cursor.continue(f(n)):t._cursor.continue(n):t._cursor.continue()})},"delete":function(){return this._store.delete(this.primaryKey)},update:function(n){return this._store.keyPath?this._store.put(n):this._store.put(n,this.primaryKey)}}});a(at.prototype,function(){return{addEventListener:function(n,t){this._el[n]?this._el[n].push(t):this._el[n]=[t]},removeEventListener:function(n,t){var i=this._el[n],r;i&&(r=i.indexOf(t),r!==-1&&i.splice(r,1))},dispatchEvent:function(n){var t=this["on"+n.type],i,r,f;try{if(t&&t(n)===!1)return!1}catch(u){console.error(u)}if(i=this._el[n.type],i)for(r=0,f=i.length;r<f;++r){t=i[r];try{if((t.handleEvent||t)(n)===!1)return!1}catch(u){console.error(u)}}return!0}}});v(e).from(at).extend({onsuccess:null,onerror:null});v(vt).from(e).extend({onblocked:null,onupgradeneeded:null});v(c).from(e);v(ot).from(e);gt()}(window.indexedDB||window.msIndexedDB);
//# sourceMappingURL=idb-iegap.min.js.map
